# 共通タイトル・h1見出しのルール

## 基本概念

### 用語定義
- **地域キーワード**: 集客対象エリア（店舗所在地とは異なる場合あり）
- **業種キーワード**: サービス業種を表すキーワード
- **サブキーワード**: 地域・業種の詳細キーワード
- **店舗名**: 店舗情報シートの【名称】（動的変数）
- **都道府県ルール**: 地域キーワードに都道府県名を含めるかの判定

### 動的変数
- `{地域キーワード}`: 入力された地域キーワード
- `{業種キーワード}`: 入力された業種キーワード
- `{サブ地域キーワード}`: 入力されたサブ地域キーワード
- `{サブ業種キーワード}`: 入力されたサブ業種キーワード
- `{店舗名}`: 店舗情報シートの【名称】
- `{都道府県名}`: 店舗住所の都道府県名

## 1. 都道府県ルール判定

### 判定フロー
```
{地域キーワード}の種類を判定
├─ 地名(市区町村郡)・駅名・通り名・ランドマーク名
│  └─ 都道府県ルールあり: {都道府県名}+{地域キーワード}
├─ 都道府県名
│  └─ 都道府県ルールなし: {地域キーワード}のみ
├─ 都道府県/市区町村郡判別不可
│  └─ 都道府県ルールなし: {地域キーワード}のみ
├─ {地域キーワード}≠{都道府県名}
│  └─ 都道府県ルールなし: {地域キーワード}のみ
└─ 地名・駅名等なし（オンライン等）
   └─ 都道府県ルールなし: {地域キーワード}のみ
```

### 例外処理
- 地域キーワードに「都府県市区町村郡」が抜けていても追加しない
- 不明な場合はGoogle検索で確認必須

### 具体例

#### 都道府県ルールあり（都道府県名を含める場合）
```
原宿(駅名)：東京都原宿のカフェなら〜
札幌：北海道札幌の家具販売なら〜
新宿：東京都新宿の整体なら〜
横浜：神奈川県横浜の歯医者なら〜
那須塩原市：栃木県那須塩原市の葬儀なら〜
```

#### 都道府県ルールなし（都道府県名を含めない場合）
```
①都道府県名の場合
神奈川県：神奈川県の整体なら〜

②都道府県/市区町村郡判別不可の場合
福島：福島の焼き鳥なら〜
栃木：栃木のカフェなら〜
千葉：千葉の整体なら〜

③地名・駅名等なし（オンライン等）の場合
オンライン：アクセサリーの通販なら〜
通販：エシカルファッションの通販なら〜
```

## 2. 共通タイトル生成

### 基本テンプレート
```
都道府県ルールあり: {都道府県名} + {地域キーワード} の {業種キーワード} なら {店舗名}
都道府県ルールなし: {地域キーワード} の {業種キーワード} なら {店舗名}
```

### 求人案件テンプレート
```
都道府県ルールあり: {都道府県名}+{地域キーワード}の{業種キーワード}の求人なら{店舗名}
都道府県ルールなし: {地域キーワード}で{業種キーワード}の求人なら{店舗名}
```

### 文字数制限
- 目標: 18-20字
- 例外: キーワード・店舗名の都合で超過可

### 具体例

#### 都道府県ルールありの場合
```
東京都渋谷のカフェなら喫茶サテラ
北海道札幌の家具販売なら家具の森
神奈川県横浜の整体なら整体院リラックス
```

#### 都道府県ルールなしの場合
```
神奈川県の整体なら整体院リラックス
福島の焼き鳥なら焼き鳥やまもと
川西の歯医者なら歯科医院スマイル
アクセサリーの通販ならジュエリー工房
```

#### 求人案件の場合
```
東京都渋谷のカフェの求人なら喫茶サテラ
北海道札幌の家具販売の求人なら家具の森
神奈川県の整体の求人なら整体院リラックス
福島で焼き鳥の求人なら焼き鳥やまもと
```

## 3. h1見出し生成

### 基本テンプレート

#### パターン1: サブキーワードあり
```
SEO重点: {業種キーワード} + {都道府県名}「、」+ {地域キーワード} + {店舗名} | {サブキーワード} + サービス内容
カテゴリ: {業種キーワード} + {都道府県名}「、」+ {地域キーワード} + {店舗名} | {サブキーワード}
```

#### パターン2: サブキーワードなし
```
SEOクッション・店舗: {業種キーワード} + {都道府県名}「、」+ {地域キーワード} + {店舗名} | ページに合う内容
```

#### パターン3: 40字超過時
```
SEOクッション・店舗: {業種キーワード} + {都道府県名}「、」+ {地域キーワード} + ページにあった打ち出し
SEO重点: {業種キーワード} + {都道府県名}「、」+ {地域キーワード} + {サブキーワード} + サービス内容
カテゴリ: {業種キーワード} + {都道府県名}「、」+ {地域キーワード} + {サブキーワード} + サービス内容以外
※「｜」不使用、{店舗名}不使用
```

#### パターン4: 20字未満時
```
カテゴリ: {業種キーワード} + {都道府県名}「、」+ {地域キーワード} + ページに合う内容 + {店舗名} | {サブキーワード}
```

### サブキーワード2つの場合

#### ケース1: サブに同じ業種キーワードあり
```
SEO重点: {サブ業種キーワード} + {サブ地域キーワード} + {店舗名} | ページに合う内容①
カテゴリ: {サブ業種キーワード} + {サブ地域キーワード} + {店舗名} | ページに合う内容②
```

#### ケース2: サブに同じ業種キーワードなし
```
SEO重点: {業種キーワード} + {サブ地域キーワード} +「{店舗名}」 | {サブキーワード} + ページに合う内容
カテゴリ: {業種キーワード} + {サブ地域キーワード} +「{店舗名}」 | {サブキーワード}
```

### 制約条件
- {サブ地域キーワード}に拠点なし→「周辺の」追加必須
- {地域キーワード}・{業種キーワード}は左詰め必須
- 固定ページは全箇所統一不要

### サブキーワード2つの場合の具体例

#### ケース1: サブに同じ業種キーワードがある場合
```
入力例1:
- 地域: 文京区「0」
- 業種: パーソナルジム「0」
- サブ地域: 千代田「1」
- サブ業種: パーソナルジム「1」
- 店舗名: N-sports

入力例2:
- 地域: 文京区「1」
- 業種: パーソナルジム「0」
- サブ地域: 渋谷「1」
- サブ業種: パーソナルジム「1」
- 店舗名: N-sports

生成結果:
- 例1: パーソナルジムは千代田周辺のN-sports | 続けやすいプラン
- 例2: パーソナルジムは渋谷周辺のN-sports | 続けやすいプラン

※地域の「文京区」は使用せず、サブの地域「千代田」「渋谷」とサブの業種「パーソナルジム」を入れて構成
```

#### ケース2: サブに同じ業種キーワードがない場合
```
入力例1:
- 地域: 文京区「0」
- 業種: パーソナルジム「0」
- サブ地域: 千代田「1」
- サブ業種: 筋トレ「1」
- 店舗名: N-sports

入力例2:
- 地域: 文京区「1」
- 業種: パーソナルジム「0」
- サブ地域: 渋谷「1」
- サブ業種: 筋トレ「1」
- 店舗名: N-sports

生成結果:
- 例1: パーソナルジムは千代田周辺のN-sports | 筋トレでボディメイク
- 例2: パーソナルジムは渋谷周辺のN-sports | 筋トレでボディメイク

※地域の「文京区」は使用せず、サブの「千代田」「渋谷」「筋トレ」と業種「パーソナルジム」を入れて構成
```

#### 40字超過時の処理
```
入力例:
- 地域: 文京区「0」
- 業種: パーソナルジム「0」
- サブ地域: 千代田「1」
- サブ業種: 筋トレ「1」

生成結果:
- SEO重点: パーソナルジムは千代田周辺の続けやすいプラン
- カテゴリ: パーソナルジムは千代田周辺の筋トレ

※「|」を使用しない、店舗名を使用しない
```

### 具体例

#### サブキーワードありの場合
```
入力例:
- 地域キーワード: 渋谷
- 業種キーワード: カフェ
- サブキーワード: コーヒー
- 店舗名: スターバックス 渋谷店
- 都道府県名: 東京都

生成結果:
- SEO重点: カフェは東京都、渋谷のスターバックス 渋谷店 | コーヒーでリラックス
- カテゴリ: カフェは東京都、渋谷のスターバックス 渋谷店 | コーヒー
```

#### サブキーワードなしの場合
```
入力例:
- 地域キーワード: 新宿
- 業種キーワード: 整体
- 店舗名: 整体院リラックス
- 都道府県名: 東京都

生成結果:
- SEOクッション・店舗: 整体は東京都、新宿の整体院リラックス | 痛みのない施術
```

#### 40字超過時
```
入力例:
- 地域キーワード: 横浜
- 業種キーワード: パーソナルジム
- サブキーワード: 筋トレ
- 店舗名: フィットネスジム 横浜店
- 都道府県名: 神奈川県

生成結果:
- SEOクッション・店舗: パーソナルジムは神奈川県、横浜の目的に合ったトレーニング
- SEO重点: パーソナルジムは神奈川県、横浜の筋トレでボディメイク
- カテゴリ: パーソナルジムは神奈川県、横浜の筋トレで健康管理
```

#### 20字未満時
```
入力例:
- 地域キーワード: 池袋
- 業種キーワード: カフェ
- サブキーワード: コーヒー
- 店舗名: 喫茶サテラ
- 都道府県名: 東京都

生成結果:
- カテゴリ: カフェは東京都、池袋の落ち着いた空間の喫茶サテラ | コーヒー
```

## 4. 複数店舗処理

### 同一店舗名ブランド

#### 共通タイトル・SEOクッション・h1見出し
- **使用名**: ブランド名のみ（支店名除外）
- **例**: コナミスポーツクラブ

#### 店舗h1見出し
- **使用名**: ブランド名+支店名
- **例**: コナミスポーツクラブ 池袋

### 具体例

#### 同一店舗名ブランドの場合
```
入力例:
- 地域キーワード: 渋谷
- 業種キーワード: ジム
- 店舗1: コナミスポーツクラブ 池袋
- 店舗2: コナミスポーツクラブ 恵比寿
- 同一店舗名: コナミスポーツクラブ

生成結果:
- 共通タイトル: 東京都渋谷のジムならコナミスポーツクラブ
- SEOクッション: ジムは東京都、渋谷のコナミスポーツクラブ | 目的に合ったトレーニング
- h1見出し: ジムは東京都、渋谷のコナミスポーツクラブ | 目的に合ったトレーニング
- 店舗h1見出し:
  - 池袋店: ジムは東京都、渋谷のコナミスポーツクラブ 池袋 | 通いやすい立地
  - 恵比寿店: ジムは東京都、渋谷のコナミスポーツクラブ 恵比寿 | 充実した設備
```

### 異なる店舗名

#### 共通タイトル・SEOクッション・h1見出し
- **使用名**: 店舗1の店舗名（代表店舗）

#### 店舗h1見出し
- **使用名**: 各店舗の正式名

### 具体例

#### 異なる店舗名の場合
```
入力例:
- 地域キーワード: 渋谷
- 業種キーワード: ジム
- 店舗1: ネクストジム TOKYO
- 店舗2: FASTORY ラボ

生成結果:
- 共通タイトル: 東京都渋谷のジムならネクストジム TOKYO
- SEOクッション: ジムは東京都、渋谷のネクストジム TOKYO | 完全個室
- h1見出し: ジムは東京都、渋谷のネクストジム TOKYO | 完全個室
- 店舗h1見出し:
  - 店舗1: ジムは東京都、渋谷のネクストジム TOKYO | お子様連れにも対応
  - 店舗2: ジムは東京都、渋谷のFASTORY ラボ | 選べる豊富なコース
```

## 5. 店舗h1見出し（店舗2以降）

### 基本ルール
{地域キーワード}に拠点なし→「周辺の」修飾語必須

### 例
```
入力例:
- {地域キーワード}: 恵比寿「1」
- {業種キーワード}: パーソナルジム「1」
- 店舗2: フィットネス 新宿店

生成結果: {業種キーワード}は{都道府県名}、{地域キーワード}周辺の{店舗名} | 豊富なマシン
→ パーソナルジムは東京都、恵比寿周辺のフィットネス 新宿店 | 豊富なマシン
```

### 詳細例

#### 拠点なし地域の処理例
```
入力例:
- 地域キーワード: 恵比寿「1」（店舗1の拠点地域）
- 業種キーワード: パーソナルジム「1」
- 店舗1: フィットネス 恵比寿店
- 店舗2: フィットネス 新宿店
- 都道府県名: 東京都

生成結果:
- 店舗1のh1見出し: パーソナルジムは東京都、恵比寿のフィットネス 恵比寿店 | 通いやすい立地
- 店舗2のh1見出し: パーソナルジムは東京都、恵比寿周辺のフィットネス 新宿店 | 豊富なマシン

※店舗2は恵比寿に拠点がないため「周辺の」を追加
```

#### 複数店舗の詳細例
```
入力例:
- 地域キーワード: 渋谷「1」
- 業種キーワード: カフェ「1」
- 店舗1: スターバックス 渋谷店
- 店舗2: スターバックス 新宿店
- 店舗3: スターバックス 池袋店
- 都道府県名: 東京都

生成結果:
- 店舗1のh1見出し: カフェは東京都、渋谷のスターバックス 渋谷店 | コーヒーでリラックス
- 店舗2のh1見出し: カフェは東京都、渋谷周辺のスターバックス 新宿店 | 落ち着いた空間
- 店舗3のh1見出し: カフェは東京都、渋谷周辺のスターバックス 池袋店 | 充実したメニュー
```

## 6. 実装時の判定フロー

### Step 1: 都道府県ルール判定
1. {地域キーワード}の種類を特定
2. 市区町村郡・駅名・通り名・ランドマーク名 → 都道府県ルールあり
3. 都道府県名・その他 → 都道府県ルールなし
4. 判定結果に基づきテンプレート選択

### Step 2: 店舗名決定
1. 複数店舗か単一店舗か判定
2. 同一ブランドか異なるブランドか判定
3. 使用する{店舗名}を決定

### Step 3: h1見出し生成
1. {サブキーワード}の有無確認
2. 文字数制限チェック
3. 適切なテンプレート適用

### Step 4: 例外処理
1. 拠点なし地域の「周辺の」追加
2. 文字数超過時の調整
3. 重複表現の回避

## 7. エラー回避チェックリスト

- [ ] {地域キーワード}の種類判定（市区町村郡・駅名・通り名・ランドマーク名等）
- [ ] 市区町村郡等 → 都道府県ルールありの適用
- [ ] 都道府県名等 → 都道府県ルールなしの適用
- [ ] {サブ地域キーワード}に拠点なし時の「周辺の」追加
- [ ] 文字数制限内での生成
- [ ] {店舗名}の正確な使用
- [ ] テンプレートの適切な選択
- [ ] 重複表現の回避

## 8. 動的変数の実装例

### 入力データ例
```json
{
  "地域キーワード": "渋谷",
  "業種キーワード": "カフェ",
  "サブ地域キーワード": "恵比寿",
  "サブ業種キーワード": "コーヒー",
  "店舗名": "スターバックス 渋谷店",
  "都道府県名": "東京都"
}
```

### 生成結果例
```
共通タイトル: 東京都渋谷のカフェならスターバックス 渋谷店
h1見出し: カフェは東京都、渋谷のスターバックス 渋谷店 | コーヒーでリラックス
```

### 求人案件の詳細例

#### 都道府県ルールありの場合
```
入力例:
- 地域キーワード: 渋谷
- 業種キーワード: カフェ
- 店舗名: 喫茶サテラ
- 都道府県名: 東京都

生成結果:
- 共通タイトル: 東京都渋谷のカフェの求人なら喫茶サテラ
- h1見出し: カフェは東京都、渋谷の喫茶サテラ | 働きやすい環境
```

#### 都道府県ルールなしの場合
```
入力例:
- 地域キーワード: 神奈川県
- 業種キーワード: 整体
- 店舗名: 整体院リラックス
- 都道府県名: 神奈川県

生成結果:
- 共通タイトル: 神奈川県で整体の求人なら整体院リラックス
- h1見出し: 整体は神奈川県の整体院リラックス | 経験者優遇
```

#### オンライン案件の場合
```
入力例:
- 地域キーワード: オンライン
- 業種キーワード: ライター
- 店舗名: コンテンツ制作会社ABC
- 都道府県名: 東京都

生成結果:
- 共通タイトル: オンラインでライターの求人ならコンテンツ制作会社ABC
- h1見出し: ライターはオンラインのコンテンツ制作会社ABC | 在宅勤務可能
```