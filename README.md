# 可変記事ルールチェックシステム

## 📋 概要

可変記事（TSVファイル形式）を自動的にルールチェックし、薬機法・景表法に準拠した高品質な文章に修正するシステムです。**誰でも簡単に使用できる**4段階のプロセスで、プロレベルの文章チェックを実現します。

## 🎯 主な機能

- **項目別分割**: TSVファイルを項目別に自動分割
- **要素別分割**: 各項目を要素（見出し・本文等）別に分割
- **包括的ルールチェック**: 薬機法・景表法・NGワード・文字数制限等をチェック
- **自動修正提案**: 問題点を特定し、修正案を自動生成
- **辛口評価**: プロの編集者レベルの厳格な品質評価

## 📁 システム構成

```
可変/
├── 可変記事_プロンプト.md          # 4段階プロセスの指示書
├── 項目別分割ルール/                # 項目別分割のルール集
│   ├── TSV項目別分割マニュアル.md
│   ├── TSV項目別分割テンプレート.md
│   ├── 項目別分割テンプレート集.md
│   └── 項目別分割チェックリスト.md
├── ルール一覧/                     # ルールチェックの基準
│   ├── 01_書き方のルール_h1見出し.md
│   ├── 02_書き方のルール_見出し・本文.md
│   ├── 03_可変の構成ガイドライン.md
│   ├── 04_書き方のルール_業種別呼称.md
│   ├── 05_NGワード_文章構造・表記.md
│   ├── 06_NGワード_直接検索.md
│   ├── 07_NGワード_文章パターンチェック.md
│   ├── 08_NGワード_文脈・条件チェック.md
│   └── 09_薬機法景表法ルール/
├── ルールチェック統合テンプレート.md  # チェック結果のテンプレート
├── 2回目チェック_修正テンプレート.md  # 修正提案のテンプレート
└── ルールチェック結果/              # 全対象ファイルの処理結果を格納
    └── [対象ファイル名]/  # 各対象ファイルの処理結果
        ├── 項目別分割/              # 1回目：項目別分割結果
        │   ├── 項目別_TOP.md
        │   ├── 項目別_アクセス.md
        │   └── 項目別_ブログ.md
        └── チェック結果/       # 2-4回目：要素別分割・チェック・修正結果
            ├── TOP_行10_h1見出し_チェック結果.md
            ├── TOP_行14_h2中見出し_チェック結果.md
            └── TOP_行18_本文_チェック結果.md
```

## 🚀 使用方法

### 📌 推奨：ワンコマンド実行（全自動）

Claude Codeのチャットに以下をコピー&ペースト：

```
@README.md を読んで、4段階の可変記事ルールチェックを実行してください。

対象ファイル: [対象ファイル名]
```

**→ この1回のコマンドで4段階すべてが自動実行されます**

### 📋 実行される4段階のプロセス

1. **項目別分割** → TSVを項目別に分割
2. **要素別分割** → 要素別ファイルを生成
3. **ルールチェック** → 厳格なルールチェック実行
4. **修正提案** → 辛口評価で修正案提示

### 前提条件

- **Claude Code** が利用可能であること
- TSVファイル（.csv形式でも可）が準備されていること
- 基本的なコピー&ペースト操作ができること

### ⚙️ 手動実行（段階別）

必要に応じて段階別実行も可能：

#### 🔸 1回目：項目別分割

**目的**: TSVファイルを項目別に分割し、各項目のMarkdownファイルを生成

**実行手順**:
1. Cursor Agentのチャットに以下をコピー&ペースト：

```
@可変記事_プロンプト.md の1回目の指示を実行してください。

対象ファイル: [対象ファイル名]
```

2. Agentが自動的に以下を実行：
   - TSVファイルの列読み解析
   - 項目名の抽出（TOP、アクセス、ブログ等）
   - 各項目の構造パターン判定
   - `ルールチェック結果/[対象ファイル名]/項目別分割/` フォルダに結果を保存

**出力例**:
```
ルールチェック結果/[対象ファイル名]/項目別分割/
├── 項目別_TOP.md
├── 項目別_アクセス.md
├── 項目別_ブログ.md
└── ...
```

#### 🔸 2回目：要素別分割

**目的**: 項目別分割されたファイルを要素（h1見出し、本文等）別に分割

**実行手順**:
1. Cursor Agentのチャットに以下をコピー&ペースト：

```
@可変記事_プロンプト.md の2回目の指示を実行してください。

対象ファイル: [対象ファイル名]
```

2. Agentが自動的に以下を実行：
   - 各 `項目別_[項目名].md` を読み込み
   - ファイル内容を要素ごとに分解
   - `ルールチェック結果/[対象ファイル名]/チェック結果/` フォルダに結果を保存

**出力例**:
```
ルールチェック結果/[対象ファイル名]/チェック結果/
├── TOP_行10_h1見出し_チェック結果.md
├── TOP_行14_h2中見出し_チェック結果.md
├── TOP_行18_本文_チェック結果.md
└── ...
```

#### 🔸 3回目：ルールチェック

**目的**: 要素別分割されたファイルを1つずつ丁寧にルールチェックを実施

**実行手順**:
1. Cursor Agentのチャットに以下をコピー&ペースト：

```
@可変記事_プロンプト.md の3回目の指示を実行してください。

対象ファイル: [対象ファイル名]
```

2. Agentが自動的に以下をチェック：
   - **ファイルごとの処理**: `ルールチェック結果/[対象ファイル名]/チェック結果/` フォルダ内の各ファイルを1つずつ開く
   - **要素タイプ判定**: h1見出し、h2中見出し、本文等の要素タイプを確認
   - **文字数制限チェック**: 各要素に設定された文字数制限を確認
   - **要素タイプ制約の確認**: 
     * 「大見出し」「中見出し」「小見出し」はTOP列のみに存在
     * その他の列には「h1見出し」「h2中見出し」「本文」のみ存在
   - **包括的ルールチェック**:
     - 基本構造（文字数制限、要素タイプ適合性）
     - 文章構造（句読点、都道府県ルール、語尾表現、表記統一）
     - NGワード（薬機法・景表法・JCIAガイドライン）
     - キーワード使用（使用回数、文頭使用、重複）
     - 業種別呼称（お客様呼称、呼称統一）
     - 文章パターン（語尾重複、意味重複、短文羅列）

3. 各ファイルのチェック結果を既存ファイルに追記

**チェック項目詳細**:
- ✅ OK / ❌ NG / ⚠️ RISK / 📋 事実確認 の判定
- 危険度スコア（100/90/80等）
- 具体的な違反理由と根拠
- 推奨される代替表現
- 詳細な文字数カウント（各文字を番号付きで表示）

#### 🔸 4回目：修正提案

**目的**: 3回目のチェック結果を基に、問題点を修正した改善案を提案

**実行手順**:
1. Cursor Agentのチャットに以下をコピー&ペースト：

```
@可変記事_プロンプト.md の4回目の指示を実行してください。

対象ファイル: [対象ファイル名]
```

2. Agentが自動的に以下を実行：
   - `ルールチェック結果/[対象ファイル名]/チェック結果/` フォルダ内の既存のチェック結果ファイルを1つずつ開く
   - **優先順位**に従って修正：
     1. **NGワード除去**（最重要 - 全て除去必須）
     2. **文字数調整**（指定範囲内に収める）
     3. **自然な日本語**（可能な範囲で）
   - 修正案を複数提示（修正案1、修正案2、推奨修正案）
   - 辛口評価とコメントを提供
   - **文字数カウント確認**: 修正後の文字数を詳細にカウント

**修正内容例**:
- NGワードの削除・置換
- 文字数の調整（削除・追加）
- 句読点の修正
- 語尾表現の改善
- 表記の統一
- 文章の自然さ向上

## 📊 チェック基準

### 文字数制限

| 要素タイプ | 文字数範囲 | 備考 |
|-----------|-----------|------|
| h1見出し | 20-40文字 | 業種+都道府県+地域+店舗名+サブキーワード |
| h2中見出し | 15-18文字 | 要約リード文/導線文 |
| 本文 | 140-180文字 | 項目により異なる（140-150文字または170-180文字） |

### 主要NGワード

- **効果最大表現**: 最大・最高・最強・最良・究極・完璧・絶対・必ず・確実・100%
- **医療機器**: 医療機器に該当する表現
- **感嘆符**: ！・？
- **過度敬語**: 過度な敬語表現
- **推量表現**: かもしれない・可能性がある等
- **口語表現**: ですよ・ですね等

### 法的リスク評価

| 危険度 | スコア | 対応 |
|--------|--------|------|
| 🔴 高リスク | 100-90 | 即座修正必須 |
| 🟡 中リスク | 80-70 | 要注意・修正推奨 |
| 🟢 低リスク | 60-50 | 問題なし |
| ⚪ リスクなし | 50未満 | 問題なし |

## 🎯 使用例

### 実際の実行例

```
【1回目実行】
対象ファイル: salon de kirei2.csv
→ ルールチェック結果/salon de kirei2/項目別分割/ フォルダに10個の項目別ファイルを生成

【2回目実行】
対象ファイル: salon de kirei2
→ ルールチェック結果/salon de kirei2/チェック結果/ フォルダに30個の要素別ファイルを生成

【3回目実行】
対象ファイル: salon de kirei2
→ TSVファイルを直接読み取り、各行のルールチェック結果を個別ファイルとして生成

【4回目実行】
対象ファイル: salon de kirei2
→ 既存のチェック結果ファイルに修正提案と辛口評価を追記
```

### 出力ファイル例

```
ルールチェック結果/
└── salon de kirei2/
    ├── 項目別分割/
    │   ├── 項目別_TOP.md
    │   ├── 項目別_アクセス.md
    │   └── 項目別_ブログ.md
    └── チェック結果/
        ├── TOP_行10_h1見出し_チェック結果.md
        │   ├── チェック対象情報
        │   ├── 基本構造チェック
        │   ├── 文章構造・表記チェック
        │   ├── NGワードチェック
        │   ├── 薬機法・景表法チェック
        │   ├── 総合判定
        │   └── 改善提案（4回目で追記）
        └── ...
```

## ⚠️ 重要な注意事項

### 実行前の確認

- [ ] TSVファイルが正しい形式であることを確認
- [ ] 必要なルールファイルが揃っていることを確認
- [ ] 出力先フォルダの容量に余裕があることを確認

### 実行中の注意

- **1行ずつ丁寧に処理**: 一括処理ではなく、1行1行、1ファイルずつ処理
- **正確な内容抽出**: 元ファイルとの照合を必ず行い、勝手に文章を作成しない
- **ルールの厳格な遵守**: 薬機法・景表法のルールを絶対に逸脱しない
- **文字数カウントの正確性**: 各文字を番号付きで表示し、総文字数を明記

### よくある問題と解決方法

#### Q1: 項目名が分からない
**A1**: TSVファイルの3-4行目を確認してください。通常「項目」という列があります。

#### Q2: データが0文字の場合
**A2**: 0文字の場合は「0文字」として記録し、内容は空欄にしてください。

#### Q3: チェック結果ファイルが存在しない
**A3**: 2回目の要素別分割が完了していることを確認してください。

#### Q4: 修正提案が不適切
**A4**: 4回目の修正提案で、より適切な修正案が提供されます。

## 🔧 トラブルシューティング

### エラーの対処法

1. **ファイルが見つからない**
   - ファイルパスが正しいか確認
   - ファイル名のスペルミスをチェック

2. **処理が途中で止まる**
   - ファイルの文字エンコーディングを確認（UTF-8推奨）
   - ファイルサイズが大きすぎないか確認

3. **チェック結果が不正確**
   - 元ファイルの内容を再確認
   - ルールファイルが最新版か確認

### パフォーマンス最適化

- **大容量ファイル**: 分割して処理することを推奨
- **複数ファイル**: 1つずつ順番に処理
- **メモリ不足**: 不要なファイルを削除して容量を確保

## 📞 サポート

### システムの特徴

- **完全自動化**: 人間の介入なしで4段階のプロセスを実行
- **高精度チェック**: 薬機法・景表法を含む包括的なルールチェック
- **辛口評価**: プロの編集者レベルの厳格な品質評価
- **詳細な修正提案**: 複数の修正案と理由を提示

### 品質保証

- **法的リスク評価**: 薬機法・景表法違反の危険度を数値化
- **文字数制限チェック**: 各要素の文字数制限を厳格にチェック
- **NGワード検出**: 包括的なNGワードデータベースで検出
- **構造チェック**: 文章構造・表記の統一性をチェック

## 🤖 Claude Code向け実行指示

このREADME.mdが参照された場合、以下の順序で自動実行してください：

### 実行フロー
1. `@可変記事_プロンプト.md` の1回目指示を実行（項目別分割）
2. `@可変記事_プロンプト.md` の2回目指示を実行（要素別分割）
3. `@可変記事_プロンプト.md` の3回目指示を実行（ルールチェック）
4. `@可変記事_プロンプト.md` の4回目指示を実行（修正提案）

### 実行条件
- 対象ファイルが指定されている
- 可変記事フォルダ内にTSVファイルが存在する
- 全ルールファイルが参照可能である

### 完了報告
全4段階完了後、処理結果サマリーを表示する

## 🎉 まとめ

このシステムを使用することで、**誰でも簡単に**プロレベルの文章チェックと修正が可能になります。

**推奨**: `@README.md` + `対象ファイル:` のワンコマンドで全自動実行

---

*このシステムは、文章の品質向上と法的リスクの軽減を目的として設計されています。*
